# Статусы задач (Trello-style)

## Реализованные возможности

### Бэкенд
- ✅ Таблица `statuses` с полями: id, userId, name, color, isDefault, order
- ✅ Поле `statusId` в таблице `todos` с внешним ключом
- ✅ API эндпоинты для управления статусами: GET, POST, PUT, DELETE `/api/statuses`
- ✅ Автоматическая инициализация статусов по умолчанию при регистрации
- ✅ Автоматическая установка `completed = true` при изменении статуса на "Готово"
- ✅ Валидация: нельзя удалить статус, используемый в задачах

### Фронтенд
- ✅ Store для управления статусами (`statusStore`)
- ✅ Компонент выбора статуса (`TodoStatusSelector`) с цветными индикаторами
- ✅ Отображение статуса в карточке задачи
- ✅ Фильтрация задач по статусу
- ✅ Статистика по статусам в `TodoStats`
- ✅ Интеграция с существующим UI

## Статусы по умолчанию

При регистрации пользователя автоматически создаются 3 статуса:

1. **К выполнению** (синий, #3b82f6) - order: 1
2. **В работе** (желтый, #eab308) - order: 2
3. **Готово** (зеленый, #22c55e) - order: 3, isDefault: true

## Миграции базы данных

### Выполнение миграций

```bash
cd server
npm run migrate
```

### Миграции

1. `002_create_statuses.sql` - создание таблицы статусов
2. `003_add_status_to_todos.sql` - добавление поля statusId в todos

## API Endpoints

### Статусы

- `GET /api/statuses` - получить все статусы пользователя
- `POST /api/statuses` - создать новый статус
  ```json
  {
    "name": "На проверке",
    "color": "#f59e0b",
    "isDefault": false,
    "order": 3
  }
  ```
- `PUT /api/statuses/:id` - обновить статус
- `DELETE /api/statuses/:id` - удалить статус (если не используется)

### Задачи

Обновлены методы для поддержки `statusId`:
- `POST /api/todos` - создать задачу (с опциональным statusId)
- `PUT /api/todos/:id` - обновить задачу (включая statusId)

## Использование

### Создание пользовательского статуса

В будущем можно добавить UI для управления статусами через компонент `StatusManager`.

### Изменение статуса задачи

1. Кликнуть на кнопку статуса в карточке задачи
2. Выбрать новый статус из выпадающего списка
3. Статус автоматически обновится

### Фильтрация по статусу

1. Открыть меню фильтров
2. Выбрать раздел "Статус"
3. Выбрать нужный статус

## Drag & Drop (в разработке)

Для реализации drag & drop между статусами установлены библиотеки:
- `@dnd-kit/core`
- `@dnd-kit/sortable`
- `@dnd-kit/utilities`
- `@dnd-kit/modifiers`

Следующий шаг: создать компонент с колонками статусов и реализовать перетаскивание задач.

